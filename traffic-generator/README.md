# Failover Test Traffic Generator

Route53 경유 DR Failover 테스트용 트래픽 생성기입니다.

## 동작 방식

```
트래픽 생성기 → *.tier1.ddos.io.kr (와일드카드)
                      ↓
              Route53 가중치 라우팅 (80:20)
                    ↙    ↘
               서울 ALB   도쿄 ALB
```

- 와일드카드 서브도메인으로 DNS 캐싱 우회
- Route53이 가중치(80:20)에 따라 서울/도쿄 분배
- 서울 HC DOWN 시 자동으로 도쿄 100% 전환

## 사용법

```bash
# 기본 (500 req/min)
node src/generator.js

# 요청량 조절
node src/generator.js --rpm 300

# 10분간 실행
node src/generator.js --duration 600

# 쓰기 비율 50%
node src/generator.js --write-ratio 0.5
```

## 출력 예시

```
============================================================
실행 시간: 5분 30초
------------------------------------------------------------
총 요청: 2750 (500 req/min)
성공: 2745 (99.8%)
에러: 5
읽기/쓰기: 1925/825
------------------------------------------------------------
리전별 분배:
  ap-northeast-2: 2196 (80.0%)
  ap-northeast-1: 549 (20.0%)
============================================================
```

## 테스트 절차

1. 트래픽 생성 시작
2. CloudWatch 대시보드에서 메트릭 관측
3. 수동 장애 주입 (서울 ALB 차단 + Write Forwarding OFF)
4. 리전별 분배 변화 확인 (서울 80% → 0%, 도쿄 20% → 100%)
5. 수동 Failover 실행
6. 안정화 확인
